define("sf.b2c.mall.center.register",["can","jquery","md5","sf.b2c.mall.api.user.downSmsCode","sf.b2c.mall.api.user.mobileRegister"],function(e,t,n,r,i){var s="请输入您的手机号码",o="您的手机号码输入有误",u="请输入验证码",a="您输入的验证码有误，请重新输入",f="请设置登录密码",l="密码请设置6-18位字母、数字或标点符号",c={1000020:"用户已注册，上线时将短信提醒",1000230:"手机号错误，请输入正确的手机号",1000240:"手机验证码错误",1000250:"手机验证码错误"},h={"-140":"请输入您的手机号码",1000010:"未找到手机用户",1000020:"用户已注册，上线时将短信提醒",1000070:"参数错误",1000230:"手机号错误，请输入正确的手机号",1000270:"短信请求太过频繁,请稍后重试",1000290:"短信请求太多"};return e.Control.extend({init:function(){this.component={},this.component.downSmsCode=new r,this.component.mobileRegister=new i,this.data=new e.Map({mobileNum:null,mobileCode:null,password:null,ischecked:!0}),this.render(this.data),this.functionPlaceHolder(document.getElementById("input-mobile-num")),this.functionPlaceHolder(document.getElementById("input-mobile-code"))},render:function(t){var n=e.view("templates/component/sf.b2c.mall.register.mustache",t);this.element.html(n)},checkMobile:function(e){return e?/^1\d{10}$/.test(e)?!0:(this.element.find("#input-mobile-error").text(o).show(),!1):(this.element.find("#input-mobile-error").text(s).show(),!1)},checkCode:function(e){return e?/^\d{6}$/.test(e)?!0:(this.element.find("#mobile-code-error").text(a).show(),!1):(this.element.find("#mobile-code-error").text(u).show(),!1)},checkPassword:function(e){return e?/^[0-9a-zA-Z~!@#\$%\^&\*\(\)_+=-\|~`,./<>\[\]\{\}]{6,18}$/.test(e)?!0:(this.element.find("#pwdErrorTips").text(l).show(),!1):(this.element.find("#pwdErrorTips").text(f).show(),!1)},"#agree-and-register click":function(e,r){r&&r.preventDefault(),t("#input-mobile-error").hide(),t("#mobile-code-error").hide(),t("#pwdErrorTips").hide();var i={mobileNum:this.data.attr("mobileNum"),mobileCode:this.data.attr("mobileCode"),password:this.data.attr("password")};if(this.checkMobile.call(this,i.mobileNum)&&this.checkCode.call(this,i.mobileCode)&&this.checkPassword.call(this,i.password)){this.component.mobileRegister.setData({mobile:i.mobileNum,smsCode:i.mobileCode,password:n(i.password+"www.sfht.com")});var s=i.mobileNum;this.component.mobileRegister.sendRequest().done(function(e){if(e.csrfToken){var n=t(".sf-b2c-mall-register .register"),r='<div class="register-h"><h2>抢先注册</h2><a href="#" class="btn btn-close">关闭</a></div><div class="register-b1"><span class="icon icon27"></span><h3>恭喜您注册成功!</h3><p>顺丰海淘即将正式开放，<br />届时使用手机号码<span>'+s+'</span>访问网站,抢购明星产品</p><a href="" id="btn-close-window" class="btn btn-register btn-send">确认</a></div>';n.html(r)}}).fail(function(e){if(_.isNumber(e)){var n="注册失败",r=c[e.toString()]||n;e==1000020||e==1000230?t("#input-mobile-error").text(r).show():t("#mobile-code-error").text(r).show()}})}},countTime:function(e,n){var r=this;n==0?(t(e).removeAttr("disabled"),t(e).removeClass("disable"),t(e).text("发送验证码"),n=60):(t(e).attr("disabled","disabled"),t(e).addClass("disable"),t(e).text(n+"s后重新发送"),n--,setTimeout(function(){r.countTime(e,n)},1e3))},"#btn-send-mobilecode click":function(e,n){n&&n.preventDefault();var r=this,i=60;t(e).attr("state","false");var s=this.element.find("#input-mobile-num").val();this.checkMobile.call(this,s)&&(this.component.downSmsCode.setData({mobile:s,askType:"REGISTER"}),this.component.downSmsCode.sendRequest().done(function(t){r.countTime(e,i)}).fail(function(e){if(_.isNumber(e)){var n="短信请求发送失败",r=h[e.toString()]||n;e===1000020?t("#input-mobile-error").html(r).show():t("#mobile-code-error").html(r).show()}}))},"#input-mobile-num focus":function(e,n){n&&n.preventDefault(),t("#input-mobile-error").hide()},"#input-mobile-num blur":function(e,n){n&&n.preventDefault();var r=t(e).val();r.length===11&&this.checkMobile.call(this,r)&&(t("#btn-send-mobilecode").attr("state","true"),t("#mobileNumErrorTips").fadeOut(1e3),t("#btn-send-mobilecode").attr("state")==="true"&&t("#btn-send-mobilecode").html()==="发送验证码"&&(t("#btn-send-mobilecode").removeAttr("disabled"),t("#btn-send-mobilecode").removeClass("disable")))},".btn-close click":function(e,n){n&&n.preventDefault(),t(".sf-b2c-mall-register").html("")},"#btn-close-window click":function(e,n){n&&n.preventDefault(),t(".sf-b2c-mall-register").html(""),window.location.reload()},"#input-mobile-code focus":function(e,n){n&&n.preventDefault(),t("#mobile-code-error").hide()},"#input-user-password focus":function(e,n){n&&n.preventDefault(),t(e).css("color","#333");var r=this.element.find("#input-mobile-code").val();this.checkCode.call(this,r),t("#pwdErrorTips").hide()},"#input-user-password keyup":function(e,n){t(e).siblings("label").hide()},"#input-user-password blur":function(e,n){var r=this.data.attr("password");t(e).css("color","#999"),r?t(e).siblings("label").hide():t(e).siblings("label").show()},"#default-text click":function(){t("#input-user-password").focus()},"#ischecked change":function(e,n){var r=this.data.attr("ischecked");r?(t(".btn-register").removeAttr("disabled").removeClass("disable"),e.attr("state","false")):(t(".btn-register").attr("disabled","disabled").addClass("disable"),e.attr("state","true"))},functionPlaceHolder:function(e){var t="";e&&!("placeholder"in document.createElement("input"))&&(t=e.getAttribute("placeholder"))&&(e.style.color="#999",e.onfocus=function(){this.value===t&&(this.value=""),this.style.color="#333"},e.onblur=function(){this.value===""&&(this.value=t),this.style.color="#999"},e.value===""&&(e.value=t))}})}),jQuery.fn.extend({jCountdown:function(){var e=function(e){this._target=e,this._width=50,this._height=64,this._frame=1,this._totalFrames=15,this._fps=24,this._intervalId=-1,this._value=0,this.stop=function(){clearInterval(this._intervalId)},this.update=function(e){if(e){this.frame(1),this.stop();var t=this;this._intervalId=setInterval(function(){t.frame()==t.totalFrames()?(clearInterval(t._intervalId),t.onFinish()):t.frame(t.frame()+1)},Math.ceil(1e3/this.fps()))}else this.frame(this.totalFrames())},this.value=function(e,t){if(void 0==e)return this._value;this._value=e,this.update(t)},this.onFinish=function(){},this.destroy=function(){this.stop(),this._target=null},this.width=function(e){if(void 0==e)return this._width;this._width=e},this.height=function(e){if(void 0==e)return this._height;this._height=e},this.frame=function(e){if(void 0==e)return this._frame;this._frame=e;var e=-(9-this.value())*this.width(),t=-(this.frame()-1)*this.height();this._target.children(".text").css("background-position",e+"px "+t+"px")},this.totalFrames=function(e){if(void 0==e)return this._totalFrames;this._totalFrames=e},this.fps=function(e){if(void 0==e)return this._fps;this._fps=e},this.update(!1)},t=function(e){this._target=e,this._width=50,this._height=64,this._frame=1,this._totalFrames=15,this._fps=24,this._intervalId=-1,this._value=0,this.stop=function(){clearInterval(this._intervalId)},this.update=function(e){if(e){this.frame(1),this.stop();var t=this;this._intervalId=setInterval(function(){t.frame()==t.totalFrames()?(clearInterval(t._intervalId),t.onFinish()):t.frame(t.frame()+1)},Math.ceil(1e3/this.fps()))}else this.frame(this.totalFrames())},this.value=function(e,t){if(void 0==e)return this._value;this._value=e,this.update(t)},this.onFinish=function(){},this.destroy=function(){this.stop(),this._target=null},this.width=function(e){if(void 0==e)return this._width;this._width=e},this.height=function(e){if(void 0==e)return this._height;this._height=e},this.frame=function(e){if(void 0==e)return this._frame;this._frame=e,e=-((1+this.value())*this.height())+Math.sin((this.frame()-1)/(this.totalFrames()-1)*Math.PI/2)*this.height(),this._target.children(".text").css("background-position","0px "+e+"px")},this.totalFrames=function(e){if(void 0==e)return this._totalFrames;this._totalFrames=e},this.fps=function(e){if(void 0==e)return this._fps;this._fps=e},this.update(!1)},n=function(e){this._target=e,this._height=this._width=60,this._frame=1,this._totalFrames=15,this._fps=24,this._intervalId=-1,this._value=0,this.stop=function(){clearInterval(this._intervalId)},this.update=function(e){if(e){this.frame(1),this.stop();var t=this;this._intervalId=setInterval(function(){t.frame()==t.totalFrames()?(clearInterval(t._intervalId),t.onFinish()):t.frame(t.frame()+1)},Math.ceil(1e3/this.fps()))}else this.frame(this.totalFrames())},this.value=function(e,t){if(void 0==e)return this._value;this._value=e,this.update(t)},this.onFinish=function(){},this.destroy=function(){this.stop(),this._target=null},this.width=function(e){if(void 0==e)return this._width;this._width=e},this.height=function(e){if(void 0==e)return this._height;this._height=e},this.frame=function(e){if(void 0==e)return this._frame;this._frame=e,e=this.value()+1,9<e&&(e=0);var t=this.frame()/this.totalFrames(),n;.4<=t&&.6>=t?n=0:.4>=t?n=1-t/.4:.6<=t&&(n=(t-.6)/.4),e=-(.5<t?this.value():e)*this.height(),e-=3*(1-n),this._target.children(".text").css("background-position","0px "+e+"px").css("opacity",n),this._target.children(".cover").css("opacity",n)},this.totalFrames=function(e){if(void 0==e)return this._totalFrames;this._totalFrames=e},this.fps=function(e){if(void 0==e)return this._fps;this._fps=e},this.update(!1)},r=function(e){this._target=e,this._height=this._width=60,this._heightSmall=this._widthSmall=42,this._frame=1,this._totalFrames=15,this._fps=24,this._intervalId=-1,this._value=0,this.stop=function(){clearInterval(this._intervalId)},this.update=function(e){if(e){this.frame(1),this.stop();var t=this;this._intervalId=setInterval(function(){t.frame()==t.totalFrames()?(clearInterval(t._intervalId),t.onFinish()):t.frame(t.frame()+1)},Math.ceil(1e3/this.fps()))}else this.frame(this.totalFrames())},this.value=function(e,t){if(void 0==e)return this._value;this._value=e,this.update(t)},this.onFinish=function(){},this.destroy=function(){this.stop(),this._target=null},this.width=function(e){if(void 0==e)return this._width;this._width=e},this.height=function(e){if(void 0==e)return this._height;this._height=e},this.frame=function(e){if(void 0==e)return this._frame;this._frame=e;var e=-this.value()*this.height(),t=Math.sin((this.frame()-1)/(this.totalFrames()-1)*Math.PI/2);0<t&&.001>t?t=0:0>t&&-0.001<t&&(t=0),this._target.children(".text").css("background-position","0px "+e+"px").css("opacity",t)},this.totalFrames=function(e){if(void 0==e)return this._totalFrames;this._totalFrames=e},this.fps=function(e){if(void 0==e)return this._fps;this._fps=e},this.update(!1)},i=function(){this._days=[],this._hours=[],this._minutes=[],this._seconds=[],this._tickId=-1,this._tickDelay=100,this._timeText="",this._timeZone=0,this._time=null,this.checkTime=function(e){var t=new Date;if(this._time.getTime()<t.getTime()+6e4*t.getTimezoneOffset()){for(t=0;t<this._days.length;t++)this._days[t].value(0);for(t=0;t<this._hours.length;t++)this._hours[t].value(0);for(t=0;t<this._minutes.length;t++)this._minutes[t].value(0);for(t=0;t<this._seconds.length;t++)this._seconds[t].value(0);return this.stop(),this.onFinish(),!0}var n=this.timeFormat(this._time.getTime()-(t.getTime()+6e4*t.getTimezoneOffset()),this._days.length,this._hours.length,this._minutes.length,this._seconds.length).split("");if(!isNaN(this._time)){for(t=0;t<this._days.length;t++){var r=parseInt(n.shift(),10);r!=this._days[t].value()&&this._days[t].value(r,e)}for(t=0;t<this._hours.length;t++)r=parseInt(n.shift(),10),r!=this._hours[t].value()&&this._hours[t].value(r,e);for(t=0;t<this._minutes.length;t++)r=parseInt(n.shift(),10),r!=this._minutes[t].value()&&this._minutes[t].value(r,e);for(t=0;t<this._seconds.length;t++)r=parseInt(n.shift(),10),r!=this._seconds[t].value()&&this._seconds[t].value(r,e)}return!1},this.textFormat=function(e,t,n){for(e=e.toString();e.length<t;)e=n+e;return e.length>t&&(e=e.substr(e.length-t,t)),e},this.timeFormat=function(e,t,n,r,i){var e=Math.floor(e/1e3),s=e%60,o=Math.floor(e%3600/60),u=Math.floor(e%86400/3600);return this.textFormat(Math.floor(e/86400),t,"0")+this.textFormat(u,n,"0")+this.textFormat(o,r,"0")+this.textFormat(s,i,"0")},this.start=function(){this.stop();for(var e=0;e<this._days.length;e++)this._days[e].update();for(e=0;e<this._hours.length;e++)this._hours[e].update();for(e=0;e<this._minutes.length;e++)this._minutes[e].update();for(e=0;e<this._seconds.length;e++)this._seconds[e].update();if(!this.checkTime(!1)){var t=this;this._tickId=setInterval(function(){t.checkTime(!0)},this._tickDelay)}},this.stop=function(){for(var e=0;e<this._days.length;e++)this._days[e].stop();for(e=0;e<this._hours.length;e++)this._hours[e].stop();for(e=0;e<this._minutes.length;e++)this._minutes[e].stop();for(e=0;e<this._seconds.length;e++)this._seconds[e].stop();clearInterval(this._tickId)},this.onFinish=function(){},this.destroy=function(){for(var e=0;e<this._days.length;e++)this._days[e].destroy();for(e=0;e<this._hours.length;e++)this._hours[e].destroy();for(e=0;e<this._minutes.length;e++)this._minutes[e].destroy();for(e=0;e<this._seconds.length;e++)this._seconds[e].destroy();this._days=[],this._hours=[],this._minutes=[],this._seconds=[],this.stop()},this.items=function(e,t,n,r){this._days=e,this._hours=t,this._minutes=n,this._seconds=r},this.timeText=function(e){if(void 0==e)return this._timeText;this._timeText=e,this.time(this.timeText(),this.timeZone())},this.timeZone=function(e){if(void 0==e)return this._timeZone;this._timeZone=e,this.time(this.timeText(),this.timeZone())},this.time=function(e,t){this._timeText=e,this._timeZone=t;var n=this._timeText.split("/").join(" ").split(":").join(" ").split(" "),r=parseInt(n[0],10),i=parseInt(n[1],10)-1,s=parseInt(n[2],10),o=parseInt(n[3],10),u=parseInt(n[4],10)-60*this._timeZone,n=parseInt(n[5],10);this._time=new Date(r,i,s,o,u,n,0),this.start()}},s=function(){return u.data("countdown")},o=function(){void 0!=s()&&(s().destroy(),u.removeData("countdown"))};if(0<arguments.length){var u=this,a=s();if(1==arguments.length&&"object"==typeof arguments[0]){void 0!=a&&(o(),u.children().remove());var f=arguments[0];void 0==s()?(a=new i,u.data("countdown",a),a=s()):a=void 0;var l=parseInt(jQuery.browser&&jQuery.browser.version,10),i="string"==typeof f.timeText?f.timeText:"",o=parseFloat(f.timeZone);isNaN(o)&&(o=0);var c="string"==typeof f.style?f.style.toLowerCase():"";switch(c){case"flip":break;case"slide":break;case"crystal":break;case"metal":break;default:c="flip"}var h="string"==typeof f.color?f.color.toLowerCase():"";switch(h){case"black":break;case"white":break;default:h="black"}var p=parseInt(f.width,10);10<=p||(p=0);var d=parseInt(f.textGroupSpace,10);0<=d||(d=15);var v=parseInt(f.textSpace,10);0<v||(v=0);var m=0!=f.reflection,g=parseFloat(f.reflectionOpacity);0<g?100<g&&(g=100):g=10;var y=parseInt(f.reflectionBlur,10);0<y?10<y&&(y=10):y=0;var b=2<parseInt(f.dayTextNumber,10)?parseInt(f.dayTextNumber,10):2,w=0!=f.displayDay,E=0!=f.displayHour,S=0!=f.displayMinute,x=0!=f.displaySecond,T=0!=f.displayLabel,f="function"==typeof f.onFinish?f.onFinish:function(){},N,C="",k="";N='<div class="jCountdown">';if(w){N+='<div class="group day'+(!E&&!S&&!x?" lastItem":"")+'">';for(w=0;w<b;w++){C=" item"+(w+1),k=w==b-1?" lastItem":"",N+='<div class="container'+C+k+'">';if("slide"==c||"crystal"==c||"metal"==c)N+='<div class="cover"></div>';N+='<div class="text"></div>',N+="</div>"}T&&(N+='<div class="label"></div>'),N+="</div>"}if(E){N+='<div class="group hour'+(!S&&!x?" lastItem":"")+'">';for(w=0;2>w;w++){C=" item"+(w+1),k=1==w?" lastItem":"",N+='<div class="container'+C+k+'">';if("slide"==c||"crystal"==c||"metal"==c)N+='<div class="cover"></div>';N+='<div class="text"></div>',N+="</div>"}T&&(N+='<div class="label"></div>'),N+="</div>"}if(S){N+='<div class="group minute'+(x?"":" lastItem")+'">';for(w=0;2>w;w++){C=" item"+(w+1),k=1==w?" lastItem":"",N+='<div class="container'+C+k+'">';if("slide"==c||"crystal"==c||"metal"==c)N+='<div class="cover"></div>';N+='<div class="text"></div>',N+="</div>"}T&&(N+='<div class="label"></div>'),N+="</div>"}if(x){N+='<div class="group second lastItem">';for(w=0;2>w;w++){C=" item"+(w+1),k=1==w?" lastItem":"",N+='<div class="container'+C+k+'">';if("slide"==c||"crystal"==c||"metal"==c)N+='<div class="cover"></div>';N+='<div class="text"></div>',N+="</div>"}T&&(N+='<div class="label"></div>'),N+="</div>"}u.html(N+"</div>"),b=u.children(".jCountdown"),b.addClass(c),b.addClass(h),b.children(".group").css("margin-right",d+"px"),b.children(".group.lastItem").css("margin-right","0px"),b.children(".group").children(".container").css("margin-right",v+"px"),b.children(".group").children(".container.lastItem").css("margin-right","0px"),m&&!(jQuery.browser.msie&&10>l)&&(reflectionObject=b.clone(),reflectionObject.addClass("reflection"),T&&reflectionObject.addClass("displayLabel"),100!=g&&reflectionObject.css("opacity",g/100),0!=y&&reflectionObject.addClass("blur"+y),b=b.add(reflectionObject)),C=jQuery('<div class="jCountdownContainer"></div>'),C.append(b),u.append(C),0!=p&&(h=jQuery('<div class="jCountdownScale"></div>'),h.append(b),C.append(h),d=h.width(),v=h.height(),p/=d,m=-(1-p)*d/2,g=-(1-p)*v/2,y="scale("+p+")",C.width(d*p),C.height(v*p),jQuery.browser.msie&&8>=l?h.css("zoom",p):(h.css("transform",y).css("-moz-transform",y).css("-webkit-transform",y).css("-o-transform",y).css("-ms-transform",y),h.css("left",m).css("top",g))),l="",p=0,h=[],d=[],v=[],m=[],C=function(){};switch(c){case"flip":C=e;break;case"slide":C=t;break;case"crystal":C=r;break;case"metal":C=n}p=1;for(l=".group.day>.container.item";b.find(l+p).length;)h.push(new C(b.find(l+p))),p++;p=1;for(l=".group.hour>.container.item";b.find(l+p).length;)d.push(new C(b.find(l+p))),p++;p=1;for(l=".group.minute>.container.item";b.find(l+p).length;)v.push(new C(b.find(l+p))),p++;p=1;for(l=".group.second>.container.item";b.find(l+p).length;)m.push(new C(b.find(l+p))),p++;a.items(h,d,v,m),a.onFinish=f,a.time(i,o)}else if("string"==typeof arguments[0]&&void 0!=a)switch(arguments[0]){case"stop":a.stop();break;case"start":a.start();break;case"destroy":o(),u.children().remove()}}return this}}),define("vendor.jquery.jcountdown",function(){}),define("sf.b2c.mall.page.preheat.register",["can","jquery","sf.b2c.mall.framework.comm","sf.b2c.mall.center.register","vendor.jquery.jcountdown","sf.b2c.mall.api.user.getBirthInfo"],function(e,t,n,r,i,s){n.register(1);var o=e.Control.extend({init:function(){this.component={},this.component.getBirthInfo=new s,this.supplement(),this.render()},render:function(){this.component.getBirthInfo.sendRequest().done(function(e){t(".total-user-num").text(e.curNum)}).fail(function(){})},supplement:function(){t(".register-h li").on("click",function(){var e=t(".register-h li").index(this);return t(this).addClass("active").siblings().removeClass("active"),t(".register-b").eq(e).addClass("active").siblings().removeClass("active"),!1}),t(".register .btn-close").on("click",function(){return t(this).parents(".register").hide(300),!1}),t(window).scroll(function(){t(window).scrollTop()>300?t(".m1").stop(!0,!1).animate({height:495},700):t(".m1").stop(!0,!1).animate({height:0},700)}),t(function(){var e=new s;e.sendRequest().done(function(t){var n=e.getServerTime();for(var r=new Date(t.onlineTime),i=new Date(n),s=i.getFullYear()+"/"+(r.getMonth()+1)+"/"+r.getDate()+" "+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds(),o=i.getFullYear()+1+"/"+(i.getMonth()+1)+"/"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),u=i.getFullYear()+1e4+"/"+(i.getMonth()+1)+"/"+i.getDate()+" "+i.getHours()+":"+i.getMinutes()+":"+i.getSeconds(),i=-i.getTimezoneOffset()/60,a=[{timeText:s,timeZone:i,style:"flip",color:"white",width:0,textGroupSpace:15,textSpace:0,reflection:!1,reflectionOpacity:10,reflectionBlur:0,displayDay:!0,displayHour:!0,displayMinute:!0,displaySecond:!1,displayLabel:!0,onFinish:function(){}},{timeText:o,timeZone:i,style:"slide",color:"black",width:0,textGroupSpace:15,textSpace:0,reflection:!1,reflectionOpacity:10,reflectionBlur:0,displayDay:!0,displayHour:!0,displayMinute:!0,displaySecond:!1,displayLabel:!0,onFinish:function(){}}],s=jQuery("#countcontent"),o=jQuery("#countcontent>.page"),u=0;u<a.length-1;u++){var i=a[u],f=o.clone();f.children(".countdown").jCountdown(i),s.append(f)}}).fail(function(){})})},".sf-in-order click":function(e,t){t&&t.preventDefault(),this.component.register=new r(".sf-b2c-mall-register")}});new o("#content")}),require(["sf.b2c.mall.page.preheat.register"]);